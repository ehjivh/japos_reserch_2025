# アンケート調査システム

## 📋 目次
1. [システム概要](#システム概要)
2. [主な特徴と機能](#主な特徴と機能)
3. [活用シーン](#活用シーン)
4. [導入手順](#導入手順)
5. [運用・管理方法](#運用管理方法)
6. [トラブルシューティング](#トラブルシューティング)
7. [技術仕様](#技術仕様)
8. [サポート情報](#サポート情報)

---

## システム概要

### 🎯 このシステムについて
GoogleスプレッドシートとGoogle Apps Scriptを使用した、**無料で構築できる**アンケート調査システムです。プログラミング知識がなくても、スプレッドシートの操作だけで柔軟にアンケートを管理・運用できます。

### 🔑 基本的な仕組み
1. **会員番号とパスワード**でログイン
2. **個人情報を確認・編集**
3. **アンケートに回答**（設問はスプレッドシートで管理）
4. **内容を確認してから送信**
5. **回答データを自動保存**

### 💰 コスト
- **初期費用**: 0円（Googleアカウントのみ必要）
- **運用費用**: 0円（Googleの無料枠内で利用可能）
- **サーバー管理**: 不要（Googleが自動管理）

---

## 主な特徴と機能

### ✅ 基本機能
- **会員制アンケート**: 会員番号・パスワードで安全にアクセス制御
- **既存データ編集**: 過去の回答を自動読み込み、修正可能
- **3種類の設問**: ラジオボタン（単一選択）、チェックボックス（複数選択）、自由記述
- **確認画面**: 送信前に回答内容を確認・修正可能
- **自動データ保存**: スプレッドシートに回答を自動保存
- **送信日時記録**: いつ回答したかを自動記録

### 🎛️ 管理機能
- **設問の表示・非表示制御**: 季節限定やテスト設問を簡単に管理
- **設問の追加・変更**: プログラム修正不要でスプレッドシートから設問を管理
- **必須項目設定**: 設問ごとに必須・任意を設定可能
- **表示順序制御**: 設問の表示順序を自由に変更

### 📱 ユーザビリティ
- **レスポンシブデザイン**: スマートフォン・タブレット・PCに対応
- **段階的な画面遷移**: 迷わず操作できる分かりやすい画面構成
- **入力バリデーション**: 必須項目の入力チェック機能
- **エラーハンドリング**: 分かりやすいエラーメッセージ表示

---

## 活用シーン

### 🎓 研究機関・大学
- **学生アンケート**: 授業評価、生活実態調査
- **研究参加者調査**: 継続的なデータ収集
- **縦断調査**: 同一対象者への複数回調査

### 🏢 企業・組織
- **従業員満足度調査**: 定期的な職場環境調査
- **顧客フィードバック**: サービス改善のための意見収集
- **研修効果測定**: 研修前後の理解度調査

### 🎪 イベント・団体
- **参加者アンケート**: イベント後の満足度調査
- **会員向け調査**: 団体運営の改善調査
- **定期モニタリング**: 継続的な意識調査

---

## 導入手順

### 📋 事前準備
**必要なもの:**
- Googleアカウント
- インターネット接続環境
- ウェブブラウザ（Chrome、Firefox、Edge等）

**所要時間:** 約30分〜1時間

### Step 1: スプレッドシートの作成

#### 1-1. 新規スプレッドシートを作成
1. [Google スプレッドシート](https://sheets.google.com)にアクセス
2. 「空白のスプレッドシート」をクリック
3. 左上の「無題のスプレッドシート」を「**アンケート調査システム**」に変更

#### 1-2. 3つのシートを作成
以下の手順で3つのシートを作成します：

1. **シート1を「会員データ」に変更**
   - シート1のタブを右クリック → 「名前を変更」→「会員データ」

2. **「設問管理」シートを追加**
   - 左下の「+」ボタンをクリック → 新規シートの名前を「設問管理」に変更

3. **「回答データ」シートを追加**
   - 再度「+」ボタンをクリック → 新規シートの名前を「回答データ」に変更

#### 1-3. 各シートのデータ構造を設定

**📊 会員データシート**
1行目（ヘッダー）に以下を入力：
```
会員番号	パスワード	氏名	メールアドレス	所属	性別	最終送信日時
```

2行目以降（サンプルデータ）に以下を入力：
```
M001	pass123	山田太郎	yamada@example.com	○○大学	男性	
M002	pass456	佐藤花子	sato@example.com	△△株式会社	女性	
M003	pass789	田中次郎	tanaka@example.com	□□研究所	男性	
```

**📋 設問管理シート**
1行目（ヘッダー）に以下を入力：
```
設問ID	設問タイトル	設問タイプ	選択肢	必須フラグ	表示順	表示フラグ
```

2行目以降（サンプル設問）に以下を入力：
```
Q001	あなたの年代を教えてください	radio	20代,30代,40代,50代以上	true	1	true
Q002	興味のある分野を選択してください（複数選択可）	checkbox	IT,医療,教育,環境,その他	true	2	true
Q003	当システムの利用頻度を教えてください	radio	毎日,週に数回,月に数回,初回	true	3	true
Q004	改善してほしい点があればお聞かせください	text		false	4	true
Q005	今後期待する機能を選択してください（複数選択可）	checkbox	モバイル対応,レポート機能,通知機能,API連携	false	5	true
```

**💾 回答データシート**
1行目（ヘッダー）に以下を入力：
```
会員番号	設問ID	回答内容	回答日時
```
2行目以降は空白のまま（回答時に自動追加されます）

### Step 2: Google Apps Scriptの設定

#### 2-1. Apps Scriptを開く
1. スプレッドシートの「拡張機能」メニューをクリック
2. 「Apps Script」を選択
3. 新しいタブでApps Scriptエディターが開きます

#### 2-2. Code.gsファイルを設定
1. 表示されている`myFunction`の内容を**すべて削除**
2. 提供された`Code.gs`の内容を**すべて貼り付け**
3. `Ctrl + S`で保存

#### 2-3. form.htmlファイルを作成
1. 左側の「+」ボタンをクリック
2. 「HTMLファイル」を選択
3. ファイル名を「**form**」に設定
4. 表示されている内容を**すべて削除**
5. 提供された`form.html`の内容を**すべて貼り付け**
6. `Ctrl + S`で保存

#### 2-4. プロジェクト名を設定
1. 左上の「無題のプロジェクト」をクリック
2. 「アンケート調査システム」に変更して保存

### Step 3: ウェブアプリとして公開

#### 3-1. デプロイを実行
1. 右上の「デプロイ」ボタンをクリック
2. 「新しいデプロイ」を選択

#### 3-2. 設定を行う
1. **種類**: 「ウェブアプリ」を選択
2. **説明**: 「アンケート調査システム v1.0」
3. **実行者**: 「自分」を選択
4. **アクセスできるユーザー**: 「全員」を選択

#### 3-3. 承認を完了
1. 「デプロイ」ボタンをクリック
2. 「アクセスを承認」をクリック
3. Googleアカウントを選択
4. 「詳細」→「アンケート調査システム（安全ではないページ）に移動」をクリック
5. 「許可」をクリック

#### 3-4. URLを取得
1. デプロイ完了後、**ウェブアプリのURL**をコピー
2. このURLがアンケートシステムのアクセスURLです

### Step 4: 動作確認

#### 4-1. 基本動作をテスト
1. 取得したURLにアクセス
2. ログイン画面が表示されることを確認

#### 4-2. ログイン機能をテスト
1. **会員番号**: `M001`
2. **パスワード**: `pass123`
3. ログインして会員情報画面が表示されることを確認

#### 4-3. アンケート機能をテスト
1. 会員情報を確認・編集
2. 「アンケートに進む」をクリック
3. 設問に回答して「確認画面へ」をクリック
4. 内容を確認して「この内容で送信」をクリック
5. 完了画面が表示されることを確認

#### 4-4. データ保存を確認
1. スプレッドシートの「回答データ」シートを確認
2. 回答が正しく保存されていることを確認
3. 「会員データ」シートで最終送信日時が更新されていることを確認

**🎉 これで導入完了です！**

---

## 運用・管理方法

### 📝 設問の管理

#### 新しい設問を追加する
1. 「設問管理」シートを開く
2. 新しい行に以下の情報を入力：
   - **設問ID**: 他と重複しない識別子（例：Q006）
   - **設問タイトル**: 実際に表示される質問文
   - **設問タイプ**: `radio`（単一選択）、`checkbox`（複数選択）、`text`（自由記述）
   - **選択肢**: カンマ区切りで入力（自由記述の場合は空白）
   - **必須フラグ**: `true`（必須）または`false`（任意）
   - **表示順**: 表示したい順番の数字
   - **表示フラグ**: `true`（表示）または`false`（非表示）

#### 設問の表示・非表示を切り替える
- **表示する**: 表示フラグを`true`に設定
- **非表示にする**: 表示フラグを`false`に設定
- **活用例**: 季節限定の設問、テスト設問、一時的に使わない設問

#### 設問タイプの説明
- **radio**: ラジオボタン（1つだけ選択）
  - 例：年代、性別、満足度など
- **checkbox**: チェックボックス（複数選択可）
  - 例：興味のある分野、利用したい機能など
- **text**: 自由記述
  - 例：意見、要望、詳細な回答など

### 👥 会員の管理

#### 新しい会員を追加する
1. 「会員データ」シートを開く
2. 新しい行に会員情報を入力
3. **会員番号は他と重複しないよう注意**

#### 会員情報を変更する
1. 該当する会員の行を見つける
2. 必要な情報を直接編集
3. **会員番号は変更しないことを推奨**

### 📊 データの分析

#### 回答データを確認する
1. 「回答データ」シートで全回答を確認
2. 設問ごと、会員ごとの回答状況を把握

#### データをエクスポートする
1. 「回答データ」シートを選択
2. 「ファイル」→「ダウンロード」→「Microsoft Excel」
3. ExcelやGoogle Data Studioで詳細分析

#### よく使用する分析
- **回答率**: 会員数に対する回答者数
- **設問別集計**: 各設問の回答分布
- **時系列分析**: 回答日時による傾向分析

---

## トラブルシューティング

### ❌ よくある問題と解決方法

#### ログインできない
**症状**: 「認証に失敗しました」と表示される  
**原因**: 会員番号・パスワードの入力ミス  
**解決策**: 
1. 「会員データ」シートで正しい会員番号・パスワードを確認
2. 全角・半角、大文字・小文字に注意して入力

#### 設問が表示されない
**症状**: アンケート画面で設問が表示されない  
**原因**: 設問管理シートの設定ミス  
**解決策**:
1. 「設問管理」シートを確認
2. 表示フラグが`true`になっているか確認
3. 設問タイプが正しく設定されているか確認

#### 「権限がありません」エラー
**症状**: システムにアクセスできない  
**原因**: スプレッドシートの共有設定  
**解決策**:
1. スプレッドシートの「共有」ボタンをクリック
2. 「リンクを知っている全員が編集可」に設定

#### データが保存されない
**症状**: 回答しても「回答データ」シートにデータが追加されない  
**原因**: Apps Scriptの実行権限  
**解決策**:
1. Apps Scriptエディターで再度承認プロセスを実行
2. ウェブアプリを再デプロイ

#### 「スプレッドシートが見つかりません」エラー
**症状**: システムエラーが表示される  
**原因**: スプレッドシート名の不一致  
**解決策**:
1. スプレッドシート名が「アンケート調査システム」になっているか確認
2. Code.gsファイル内のスプレッドシート名と一致しているか確認

### 🔧 メンテナンス

#### 定期的に行うこと
- **データのバックアップ**: 月1回程度、スプレッドシートをダウンロードして保存
- **不要データの整理**: 古い回答データの整理（必要に応じて）
- **会員情報の更新**: 退会者の削除、新規会員の追加

#### システムの更新
- **Apps Scriptの更新**: 新機能追加時のコード更新
- **デザインの変更**: form.htmlファイルの編集でUIカスタマイズ可能

---

## 技術仕様

### 🏗️ システム構成
```
[フロントエンド]
form.html (HTML/CSS/JavaScript)
↓
[バックエンド]
Code.gs (Google Apps Script)
↓
[データベース]
Googleスプレッドシート
├── 会員データシート
├── 設問管理シート
└── 回答データシート
```

### 📁 ファイル構成
- **Code.gs**: サーバーサイドロジック（認証、データ処理）
- **form.html**: フロントエンドUI（ユーザーインターフェース）
- **Googleスプレッドシート**: データ管理（3つのシート）

### 🔒 セキュリティ
#### 現在の対策
- パスワード認証による利用者制限
- Google Apps Scriptのセキュリティ機能
- セッション管理（会員番号の一時保存）

#### 注意事項
- パスワードは平文保存のため、機密性の高い用途では暗号化が必要
- ウェブアプリは「全員」アクセス可能なため、URLの管理に注意
- 本格運用時はGoogle Workspaceの利用を推奨

### 📋 データ構造詳細

#### 会員データシート
| 列  | 項目名         | データ型 | 説明                           |
| --- | -------------- | -------- | ------------------------------ |
| A   | 会員番号       | 文字列   | ユニークな識別子               |
| B   | パスワード     | 文字列   | 認証用パスワード               |
| C   | 氏名           | 文字列   | 会員氏名                       |
| D   | メールアドレス | 文字列   | 連絡先メール                   |
| E   | 所属           | 文字列   | 所属組織                       |
| F   | 性別           | 文字列   | 性別情報                       |
| G   | 最終送信日時   | 日時     | 最後にアンケートを送信した日時 |

#### 設問管理シート
| 列  | 項目名       | データ型 | 説明                           |
| --- | ------------ | -------- | ------------------------------ |
| A   | 設問ID       | 文字列   | ユニークな設問識別子           |
| B   | 設問タイトル | 文字列   | 設問の表示タイトル             |
| C   | 設問タイプ   | 文字列   | radio/checkbox/text            |
| D   | 選択肢       | 文字列   | カンマ区切りの選択肢           |
| E   | 必須フラグ   | ブール   | true/false                     |
| F   | 表示順       | 数値     | 表示順序                       |
| G   | 表示フラグ   | ブール   | true/false（表示・非表示制御） |

#### 回答データシート
| 列  | 項目名   | データ型 | 説明             |
| --- | -------- | -------- | ---------------- |
| A   | 会員番号 | 文字列   | 回答者の会員番号 |
| B   | 設問ID   | 文字列   | 回答した設問のID |
| C   | 回答内容 | 文字列   | 実際の回答       |
| D   | 回答日時 | 日時     | 回答した日時     |

---

## サポート情報

### 📚 関連ドキュメント
- **このREADME.md**: 基本的な使い方と導入手順
- **Code.gs**: サーバーサイドコード（技術者向け）
- **form.html**: フロントエンドコード（技術者向け）

### 🆘 困ったときは
1. **まずはトラブルシューティングを確認**
2. **Googleスプレッドシートの設定を確認**
3. **エラーメッセージをよく読む**
4. **サンプルデータと比較して設定を確認**

### 🔧 カスタマイズについて
- **デザイン変更**: form.htmlのCSSを編集
- **機能追加**: Code.gsにJavaScript関数を追加
- **データ構造変更**: スプレッドシートの列を追加・変更

### 📈 今後の拡張可能性
- **データ分析機能**: Google Data Studioとの連携
- **通知機能**: 回答完了時のメール通知
- **API連携**: 外部システムとのデータ連携
- **セキュリティ強化**: パスワード暗号化、IP制限

---

## ✅ 導入完了チェックリスト

### Step 1: スプレッドシート作成
- [ ] スプレッドシート「アンケート調査システム」を作成
- [ ] 3つのシート（会員データ、設問管理、回答データ）を作成
- [ ] 各シートにヘッダー行を入力
- [ ] サンプルデータを入力

### Step 2: Apps Script設定
- [ ] Code.gsファイルを作成・貼り付け
- [ ] form.htmlファイルを作成・貼り付け
- [ ] プロジェクト名を設定

### Step 3: デプロイ
- [ ] ウェブアプリとしてデプロイ
- [ ] 承認プロセスを完了
- [ ] ウェブアプリURLを取得・保存

### Step 4: 動作確認
- [ ] ログイン機能をテスト
- [ ] アンケート機能をテスト
- [ ] データ保存をテスト

### Step 5: 運用開始
- [ ] 実際の会員データを入力
- [ ] 実際の設問を作成
- [ ] URLを関係者に共有

**🎉 おめでとうございます！アンケート調査システムの導入が完了しました！**

---

*最終更新: 2025年7月13日*

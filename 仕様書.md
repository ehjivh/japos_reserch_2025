# アンケート調査システム仕様書

## 1. システム概要
GoogleスプレッドシートとGoogle Apps Scriptを使用したアンケート調査システム。
会員認証後に既存データを編集可能とし、設問内容をスプレッドシートで管理する。

## 2. 機能要件

### 2.1 認証機能
- 会員番号・パスワードによる認証
- 認証成功後にユーザーの既存データを表示

### 2.2 アンケート機能
- 動的な設問表示（スプレッドシートから設問を読み込み）
- 設問の表示・非表示制御（表示フラグによる管理）
- 複数の回答形式をサポート
  - ラジオボタン（単一選択）
  - チェックボックス（複数選択）
  - 自由記述（テキスト入力）
- 確認画面での回答内容確認
- 編集・送信機能

### 2.3 データ管理機能
- 既存データの取得と表示
- 回答データの保存
- 送信日時の記録

## 3. データ構造

### 3.1 会員データベースシート（シート名：会員データ）
| 列  | 項目名         | 型     | 説明                           |
| --- | -------------- | ------ | ------------------------------ |
| A   | 会員番号       | 文字列 | ユニークな識別子               |
| B   | パスワード     | 文字列 | 認証用パスワード               |
| C   | 氏名           | 文字列 | 会員氏名                       |
| D   | メールアドレス | 文字列 | 連絡先メール                   |
| E   | 所属           | 文字列 | 所属組織                       |
| F   | 性別           | 文字列 | 性別情報                       |
| G   | 最終送信日時   | 日時   | 最後にアンケートを送信した日時 |

### 3.2 設問管理シート（シート名：設問管理）
| 列  | 項目名       | 型     | 説明                                   |
| --- | ------------ | ------ | -------------------------------------- |
| A   | 設問ID       | 文字列 | ユニークな設問識別子                   |
| B   | 設問タイトル | 文字列 | 設問の表示タイトル                     |
| C   | 設問タイプ   | 文字列 | radio/checkbox/text                    |
| D   | 選択肢       | 文字列 | カンマ区切りの選択肢（textの場合は空） |
| E   | 必須フラグ   | ブール | true/false                             |
| F   | 表示順       | 数値   | 表示順序                               |
| G   | 表示フラグ   | ブール | true/false（設問の表示・非表示制御）   |

### 3.3 回答データシート（シート名：回答データ）
| 列  | 項目名   | 型     | 説明                                       |
| --- | -------- | ------ | ------------------------------------------ |
| A   | 会員番号 | 文字列 | 回答者の会員番号                           |
| B   | 設問ID   | 文字列 | 回答した設問のID                           |
| C   | 回答内容 | 文字列 | 実際の回答（複数選択の場合はカンマ区切り） |
| D   | 回答日時 | 日時   | 回答した日時                               |

## 4. 画面仕様

### 4.1 ログイン画面
- 会員番号入力フィールド
- パスワード入力フィールド
- ログインボタン
- エラーメッセージ表示エリア

### 4.2 アンケート画面
- ユーザー情報表示エリア
- 動的設問表示エリア
- 確認画面へボタン

### 4.3 確認画面
- 回答内容一覧表示
- 修正ボタン
- 送信ボタン

### 4.4 完了画面
- 送信完了メッセージ
- 新規回答ボタン（ログイン画面に戻る）

## 5. 技術仕様

### 5.1 使用技術
- Google Apps Script
- HTML/CSS/JavaScript
- Google Spreadsheets API

### 5.2 ファイル構成
- `Code.gs` - サーバーサイドロジック
- `form.html` - フロントエンドHTML
- Google スプレッドシート - データ管理

### 5.3 セキュリティ
- パスワード認証による利用者制限
- セッション管理（会員番号の一時保存）
- データバリデーション

## 6. 設定変更の考慮事項

### 6.1 設問の追加・変更
- 設問管理シートで設問を追加・編集可能
- アプリケーション再デプロイ不要
- 設問タイプ、選択肢、必須フラグの変更対応
- 表示フラグによる設問の表示・非表示切り替え
- 設問の一時的な無効化（非表示設定）が可能

### 6.2 レイアウト調整
- CSS変更による外観カスタマイズ
- レスポンシブデザイン対応

## 7. 導入要件
- Googleアカウント（Google Workspace推奨）
- スプレッドシート作成権限
- Apps Script実行権限
- ウェブアプリ公開権限

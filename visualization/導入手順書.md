# アンケート回答データ可視化システム 導入手順書

## 📋 概要
本手順書では、既存のアンケート調査システムに可視化機能を追加する方法を説明します。

## 🔧 前提条件
- 既存のアンケート調査システムが稼働していること
- スプレッドシート「アンケート調査システム」が存在すること
- Google Apps Scriptの基本操作ができること

## 📅 所要時間
約15-30分

---

## Step 1: 新しいApps Scriptプロジェクトの作成

### 1-1. Google Apps Scriptを開く
1. [Google Apps Script](https://script.google.com)にアクセス
2. 「新しいプロジェクト」をクリック

### 1-2. プロジェクト名を設定
1. 左上の「無題のプロジェクト」をクリック
2. 「**アンケート可視化システム**」に変更して保存

### 1-3. コードファイルを作成
1. 表示されている`myFunction`の内容を**すべて削除**
2. 提供された`visualization.gs`の内容を**すべて貼り付け**
3. `Ctrl + S`で保存

---

## Step 2: HTMLファイルの追加

### 2-1. HTMLファイルを作成
1. 左側の「+」ボタンをクリック
2. 「HTMLファイル」を選択
3. ファイル名を「**visualization**」に設定

### 2-2. HTMLコードを貼り付け
1. 表示されている内容を**すべて削除**
2. 提供された`visualization.html`の内容を**すべて貼り付け**
3. `Ctrl + S`で保存

---

## Step 3: ウェブアプリとしてデプロイ

### 3-1. デプロイを実行
1. 右上の「デプロイ」ボタンをクリック
2. 「新しいデプロイ」を選択

### 3-2. 設定を行う
1. **種類**: 「ウェブアプリ」を選択
2. **説明**: 「アンケート可視化システム v1.0」
3. **実行者**: 「自分」を選択
4. **アクセスできるユーザー**: 「全員」を選択

### 3-3. 承認を完了
1. 「デプロイ」ボタンをクリック
2. 「アクセスを承認」をクリック
3. Googleアカウントを選択
4. 「詳細」→「アンケート可視化システム（安全ではないページ）に移動」をクリック
5. 「許可」をクリック

### 3-4. URLを取得
1. デプロイ完了後、**ウェブアプリのURL**をコピー
2. このURLが可視化システムのアクセスURLです

---

## Step 4: 動作確認

### 4-1. 基本動作をテスト
1. 取得したURLにアクセス
2. 可視化システムのダッシュボードが表示されることを確認

### 4-2. データ表示をテスト
1. **全設問概要**ボタンをクリック
2. 各設問のグラフが正しく表示されることを確認

### 4-3. 個別設問表示をテスト
1. 設問ボタンをクリック
2. 設問タイプに応じたグラフが表示されることを確認：
   - **ラジオボタン**: 円グラフ・棒グラフ
   - **チェックボックス**: 棒グラフ
   - **テキスト**: ワードクラウド、文字数分布、回答一覧

### 4-4. 機能テスト
1. **グラフ切替**ボタンの動作確認（ラジオボタン設問）
2. **画像保存**ボタンの動作確認
3. **データ更新**ボタンの動作確認
4. **キーワード検索**機能の動作確認（テキスト設問）

---

## Step 5: カスタマイズ（オプション）

### 5-1. デザインのカスタマイズ
`visualization.html`のCSSセクションを編集してデザインを変更できます：

```css
/* 色の変更例 */
.header {
  background: linear-gradient(135deg, #your-color1 0%, #your-color2 100%);
}

.stat-number {
  color: #your-primary-color;
}
```

### 5-2. グラフの色設定
グラフの色を変更する場合：

```javascript
// visualization.html内のJavaScriptセクション
// backgroundColor配列を編集
backgroundColor: [
  '#your-color1', '#your-color2', '#your-color3', // お好みの色に変更
]
```

---

## 📊 使用方法

### ダッシュボード
- **統計カード**: 総会員数、回答者数、回答率、設問数が表示
- **設問ボタン**: 各設問を個別に分析
- **全設問概要**: すべての設問の概要を一覧表示

### グラフの種類

#### ラジオボタン設問
- **円グラフ**: 選択肢の割合を視覚的に表示
- **棒グラフ**: 選択肢の回答数を比較
- **切替可能**: グラフ切替ボタンで表示方法を変更

#### チェックボックス設問
- **棒グラフ**: 各選択肢の選択頻度を表示
- **複数選択対応**: 合計が100%を超える場合あり

#### テキスト設問
- **ワードクラウド**: 頻出キーワードを文字サイズで表現
- **文字数分布**: 回答の長さの分布をヒストグラムで表示
- **回答一覧**: 全回答の詳細表示（検索機能付き）

### エクスポート機能
- **画像保存**: グラフをPNG形式でダウンロード
- **データエクスポート**: 将来的にCSV出力機能を追加予定

---

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### データが表示されない
**症状**: グラフやデータが表示されない  
**原因**: スプレッドシート名の不一致  
**解決策**: 
1. スプレッドシート名が「アンケート調査システム」になっているか確認
2. 3つのシート（会員データ、設問管理、回答データ）が存在するか確認

#### 「権限がありません」エラー
**症状**: システムにアクセスできない  
**原因**: スプレッドシートの共有設定  
**解決策**:
1. 元のスプレッドシートの「共有」ボタンをクリック
2. 「リンクを知っている全員が編集可」に設定

#### グラフが正しく表示されない
**症状**: グラフの形状がおかしい  
**原因**: データの形式問題  
**解決策**:
1. 設問管理シートの設問タイプが正しく設定されているか確認
2. 回答データに不正な形式のデータがないか確認

#### ワードクラウドが表示されない
**症状**: テキスト設問でキーワードが表示されない  
**原因**: 回答データが短すぎる、または特殊文字のみ  
**解決策**:
1. テキスト回答が2文字以上の意味のある単語を含むか確認
2. 回答データを確認して有効なテキストがあるか検証

---

## 📈 運用のコツ

### 定期的な確認
- **データ更新**: 新しい回答が追加された際は「データ更新」ボタンをクリック
- **設問の追加**: 新しい設問を追加した場合、自動的に可視化対象に含まれます

### 効果的な分析
- **時系列での比較**: 定期的にグラフを保存して傾向を把握
- **設問タイプの使い分け**: 目的に応じて適切な設問タイプを選択
- **回答パターンの分析**: チェックボックス設問で選択の組み合わせを分析

### データの活用
- **報告書作成**: 画像保存機能を使って報告書に挿入
- **改善点の発見**: テキスト設問のワードクラウドから課題を特定
- **トレンドの把握**: 定期的な分析で変化の傾向を追跡

---

## 🔄 更新・メンテナンス

### コードの更新
新機能を追加する場合：
1. Apps Scriptエディターでコードを編集
2. 保存後、新しいバージョンとしてデプロイ

### データの整理
- **古いデータの整理**: 必要に応じて回答データシートの古いデータを整理
- **バックアップ**: 定期的にスプレッドシートをダウンロードしてバックアップ

---

## 📞 サポート

### ドキュメント
- **仕様書**: `可視化システム仕様書.md`を参照
- **システム概要**: 元システムの`システム概要.md`を参照

### 技術的な問題
- **Google Apps Scriptのエラー**: エラーメッセージをもとに該当する関数を確認
- **表示の問題**: ブラウザのキャッシュをクリアして再試行
- **データの問題**: スプレッドシートの形式が仕様通りか確認

---

## ✅ 導入完了チェックリスト

### 初期設定
- [ ] Apps Scriptプロジェクトを作成
- [ ] visualization.gsファイルを作成・貼り付け
- [ ] visualization.htmlファイルを作成・貼り付け
- [ ] ウェブアプリとしてデプロイ
- [ ] 承認プロセスを完了
- [ ] アクセスURLを取得・保存

### 動作確認
- [ ] ダッシュボードの表示確認
- [ ] 統計情報の表示確認
- [ ] 設問ボタンの動作確認
- [ ] ラジオボタン設問のグラフ表示確認
- [ ] チェックボックス設問のグラフ表示確認
- [ ] テキスト設問の表示確認
- [ ] グラフ切替機能の確認
- [ ] 画像保存機能の確認

### 運用準備
- [ ] URLを関係者に共有
- [ ] 操作説明を実施
- [ ] 定期確認スケジュールを設定

**🎉 おめでとうございます！可視化システムの導入が完了しました！**

---

*最終更新: 2025年7月21日*
*バージョン: 1.0*

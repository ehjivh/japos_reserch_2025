# アンケート回答データ可視化システム

## 📊 システム概要

本システムは、既存のアンケート調査システムで収集された回答データを、設問タイプに応じて適切なグラフで可視化するGoogle Apps Script（GAS）ベースのウェブアプリケーションです。

### 🎯 主な特徴
- **設問タイプ別の最適なグラフ表示**
- **インタラクティブなダッシュボード**
- **リアルタイムデータ分析**
- **画像エクスポート機能**
- **レスポンシブデザイン対応**

---

## 🚀 クイックスタート

### 前提条件
- 既存のアンケート調査システムが稼働していること
- Googleアカウントでのアクセス権限があること

### 導入手順
1. **導入手順書**（`導入手順書.md`）に従ってシステムを設定
2. ウェブアプリURLにアクセス
3. ダッシュボードでデータを確認

詳細な導入手順は[導入手順書](./導入手順書.md)をご覧ください。

---

## 📋 機能一覧

### ダッシュボード機能
- **統計サマリー**: 総会員数、回答者数、回答率、設問数
- **設問選択ナビゲーション**: 設問別の詳細分析へのアクセス
- **全設問概要**: すべての設問の概要を一覧表示

### グラフ機能

#### ラジオボタン設問（単一選択）
- **円グラフ**: 選択肢の割合を視覚的に表示
- **棒グラフ**: 選択肢の回答数を比較表示
- **グラフ切替**: ワンクリックで表示方法を変更可能

#### チェックボックス設問（複数選択）
- **棒グラフ**: 各選択肢の選択頻度を表示
- **選択率表示**: 複数選択に対応した割合計算

#### テキスト設問（自由記述）
- **ワードクラウド**: 頻出キーワードを文字サイズで表現
- **文字数分布グラフ**: 回答の長さの分布をヒストグラムで表示
- **回答一覧テーブル**: 全回答の詳細表示
- **キーワード検索**: 特定のキーワードを含む回答を抽出

### データ分析機能
- **基本統計情報**: 回答数、選択率、平均値等
- **詳細統計**: 最頻値、中央値、分散等
- **リアルタイム更新**: データ更新ボタンで最新情報を取得

### エクスポート機能
- **グラフ画像保存**: PNG形式でグラフをダウンロード
- **データエクスポート**: 集計データの出力（今後実装予定）

---

## 🎨 画面構成

### メイン画面
```
┌─────────────────────────────────────┐
│ ヘッダー（システム名・更新ボタン）    │
├─────────────────────────────────────┤
│ 統計サマリー（4つのカード）          │
├─────────────────────────────────────┤
│ 設問選択ナビゲーション               │
├─────────────────────────────────────┤
│ グラフ表示エリア                    │
│ ├─ 個別設問表示                   │
│ └─ 全設問概要表示                 │
└─────────────────────────────────────┘
```

### 個別設問画面
```
┌─────────────────────────────────────┐
│ 設問タイトル・操作ボタン             │
├─────────────────────────────────────┤
│ グラフ表示（設問タイプに応じて）      │
│ ├─ ラジオ: 円グラフ/棒グラフ      │
│ ├─ チェックボックス: 棒グラフ      │
│ └─ テキスト: ワードクラウド等      │
├─────────────────────────────────────┤
│ 統計情報・詳細データ                │
└─────────────────────────────────────┘
```

---

## 📊 グラフの種類と特徴

### ラジオボタン設問
| グラフタイプ | 特徴                           | 用途                 |
| ------------ | ------------------------------ | -------------------- |
| 円グラフ     | 全体に対する割合を視覚的に表現 | 選択肢間の比率把握   |
| 棒グラフ     | 選択肢間の数値比較が容易       | 回答数の具体的な比較 |

**表示例:**
- 年代別回答分布
- 満足度評価
- 利用頻度調査

### チェックボックス設問
| グラフタイプ | 特徴                   | 用途                 |
| ------------ | ---------------------- | -------------------- |
| 棒グラフ     | 各選択肢の人気度を比較 | 複数選択での傾向分析 |

**表示例:**
- 興味分野（複数選択）
- 利用したい機能（複数選択）
- 問題点の指摘（複数選択）

### テキスト設問
| 表示タイプ     | 特徴                   | 用途                     |
| -------------- | ---------------------- | ------------------------ |
| ワードクラウド | 頻出キーワードを視覚化 | 主要な意見・テーマの把握 |
| 文字数分布     | 回答の詳細度を分析     | 回答品質の評価           |
| 回答一覧       | 個別回答の詳細確認     | 具体的な意見の抽出       |

**活用例:**
- 改善要望の分析
- 自由意見の傾向把握
- 課題の特定

---

## 💡 活用シーン

### 研究機関・大学
- **学会発表資料**: グラフをそのまま発表スライドに使用
- **研究論文の図表**: 調査結果の可視化
- **進捗報告書**: 研究の中間結果の報告

### 企業・組織
- **経営報告**: 従業員満足度調査の結果報告
- **改善提案**: 顧客フィードバックの分析結果
- **効果測定**: 研修・施策の効果検証

### イベント・団体
- **参加者報告**: イベント後のフィードバック分析
- **運営改善**: 次回開催に向けた改善点の抽出
- **満足度調査**: 継続的なサービス向上

---

## 🔧 カスタマイズ

### デザインのカスタマイズ
```css
/* 色の変更例（visualization.html内） */
.header {
  background: linear-gradient(135deg, #your-color1 0%, #your-color2 100%);
}

/* グラフの色設定 */
backgroundColor: [
  '#your-color1', '#your-color2', '#your-color3'
]
```

### 機能の拡張
- **新しいグラフタイプの追加**: Chart.jsの他のグラフタイプを利用
- **フィルタ機能**: 期間や属性での絞り込み
- **エクスポート機能の拡張**: PDF出力、Excel形式での出力

---

## 📈 サンプルデータ分析例

### ケース1: 利用頻度調査（ラジオボタン）
**設問**: 「当システムの利用頻度を教えてください」
**選択肢**: 毎日、週に数回、月に数回、初回

**分析結果例**:
- 毎日: 15% (3人)
- 週に数回: 45% (9人)
- 月に数回: 30% (6人)
- 初回: 10% (2人)

**考察**: 週に数回の利用が最も多く、システムが定期的に活用されている。

### ケース2: 興味分野調査（チェックボックス）
**設問**: 「興味のある分野を選択してください（複数選択可）」
**選択肢**: IT、医療、教育、環境、その他

**分析結果例**:
- IT: 65% (13人)
- 教育: 50% (10人)
- 医療: 30% (6人)
- 環境: 25% (5人)
- その他: 15% (3人)

**考察**: ITと教育分野への関心が高く、複数分野に興味を持つ回答者が多い。

### ケース3: 改善要望（テキスト）
**設問**: 「改善してほしい点があればお聞かせください」

**ワードクラウド例**:
- 「画面」(8回)
- 「操作」(6回)
- 「速度」(5回)
- 「機能」(4回)
- 「デザイン」(3回)

**考察**: 画面や操作性に関する改善要望が多く、UIの見直しが必要。

---

## 🔍 分析のポイント

### 効果的な分析方法
1. **全体傾向の把握**: まずダッシュボードで全体像を確認
2. **設問別の詳細分析**: 気になる設問の詳細を確認
3. **時系列での比較**: 定期的に同じ分析を実施して変化を追跡
4. **テキスト分析の活用**: ワードクラウドで潜在的な課題を発見

### 注意点
- **サンプル数の確認**: 回答数が少ない場合は結果の解釈に注意
- **選択肢の偏り**: 特定の選択肢に回答が集中していないか確認
- **テキストの質**: 意味のある回答かどうかを個別に確認

---

## 📞 トラブルシューティング

### よくある問題

#### グラフが表示されない
- スプレッドシート名が「アンケート調査システム」になっているか確認
- シート名が正しく設定されているか確認（会員データ、設問管理、回答データ）

#### データが古い
- 「データ更新」ボタンをクリックして最新データを取得
- ブラウザのキャッシュをクリアして再読み込み

#### 特定の設問が表示されない
- 設問管理シートの「表示フラグ」が`true`になっているか確認
- 設問IDが重複していないか確認

---

## 📚 関連ドキュメント

- **[可視化システム仕様書](./可視化システム仕様書.md)**: 技術的な詳細仕様
- **[導入手順書](./導入手順書.md)**: システムの導入方法
- **[元システムREADME](../README.md)**: 既存アンケートシステムの概要

---

## 🔄 バージョン履歴

| バージョン | 日付       | 変更内容     |
| ---------- | ---------- | ------------ |
| 1.0        | 2025/07/21 | 初回リリース |

---

## 📄 ライセンス

本システムは教育・研究目的での自由な利用を想定しています。
商用利用の場合は、使用するライブラリ（Chart.js等）のライセンスを確認してください。

---

## 🎯 今後の拡張予定

### フェーズ2（中期計画）
- **時系列分析機能**: 回答の時間的変化を分析
- **属性別クロス集計**: 会員属性による分析
- **CSV/Excel出力**: 詳細データのエクスポート

### フェーズ3（長期計画）
- **回答パターン分析**: 回答者の傾向分析
- **予測分析**: 将来の傾向予測
- **自動レポート生成**: 定期的な分析レポートの自動作成

---

*最終更新: 2025年7月21日*
*開発者: アンケート調査システム開発チーム*
